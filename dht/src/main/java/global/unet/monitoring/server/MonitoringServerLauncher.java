package global.unet.monitoring.server;

import java.util.logging.Logger;
import java.util.logging.Level;

/**
 * Класс для запуска сервера мониторинга DHT сети
 */
public class MonitoringServerLauncher {
    private static final Logger logger = Logger.getLogger(MonitoringServerLauncher.class.getName());
    
    /**
     * Точка входа для запуска сервера мониторинга
     */
    public static void main(String[] args) {
        try {
            // Определение порта
            int port = 8080;
            if (args.length > 0) {
                try {
                    port = Integer.parseInt(args[0]);
                } catch (NumberFormatException e) {
                    logger.warning("Invalid port number, using default: 8080");
                }
            }
            
            // Создание и запуск сервера
            DHTMonitoringServer server = new DHTMonitoringServer(port);
            server.start();
            
            logger.info("DHT Monitoring Server started on port " + port);
            logger.info("Press Ctrl+C to stop the server");
            
            // Добавляем обработчик для корректного завершения
            Runtime.getRuntime().addShutdownHook(new Thread(() -> {
                logger.info("Shutting down server...");
                server.stop();
                logger.info("Server stopped");
            }));
            
        } catch (Exception e) {
            logger.log(Level.SEVERE, "Failed to start monitoring server", e);
            System.exit(1);
        }
    }
}

